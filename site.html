<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Seller Alert</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* ВСТАВЬТЕ СЮДА ВЕСЬ ВАШ CSS СТИЛЬ КОТОРЫЙ ВЫ ХОТИТЕ СОХРАНИТЬ */
        body { font-family: Arial; margin: 0; padding: 0; background: #f0f2f5; }
        .tg-header { display: flex; justify-content: space-between; padding: 10px 15px; background: white; }
        .content-area { padding: 15px; }
        .welcome-section { padding: 20px 0; border-bottom: 1px solid #e0e0e0; }
        .logo { font-size: 28px; font-weight: 700; }
        .account-status { display: flex; align-items: center; gap: 10px; margin-top: 20px; }
        .add-button { width: 50px; height: 50px; background: #007aff; color: white; border-radius: 50%; text-align: center; line-height: 50px; font-size: 30px; cursor: pointer; }
        .account-pill { flex-grow: 1; padding: 10px 20px; background: #e9e9eb; border-radius: 25px; text-align: center; }
        .stats-grid { display: flex; gap: 10px; margin-top: 20px; }
        .stat-card { background: white; padding: 15px; border-radius: 12px; flex: 1; text-align: center; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; }
        .modal { background: white; padding: 20px; border-radius: 14px; width: 80%; }
    </style>
</head>
<body>
    <div class="tg-header">
        <span onclick="Telegram.WebApp.close()">Закрыть</span>
        <div class="tg-header-title">Seller Alert<small>мини-приложение</small></div>
        <span class="dots">⚫⚫⚫</span>
    </div>
    
    <div class="content-area">
        <div class="welcome-section">
            <div class="logo">seller<span>:</span>alert</div>
            <p class="welcome-text" id="greeting">Привет!</p>

            <div class="account-status">
                <div class="add-button" onclick="openTokenModal()">+</div>
                <div class="account-pill">
                    <p class="account-pill-status" id="status-text">Нажмите + для подключения WB</p>
                </div>
            </div>
        </div>

        <div class="stats-section">
            <h2>Статистика Wildberries</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Доход</h4>
                    <p id="val-income">0₽</p>
                </div>
                <div class="stat-card">
                    <h4>CTR</h4>
                    <p id="val-ctr">0%</p>
                </div>
                <div class="stat-card">
                    <h4>ДРР</h4>
                    <p id="val-drr">0%</p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="tokenModal">
        <div class="modal">
            <h3>Введите API токен WB</h3>
            <input type="text" id="apiTokenInput" placeholder="Ваш токен...">
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button onclick="closeTokenModal()" style="flex:1; padding:10px; background:#e9e9eb; border:none; border-radius:8px;">Отмена</button>
                <button onclick="connectToWB()" style="flex:1; padding:10px; background:#007aff; color:white; border:none; border-radius:8px;">Подключить</button>
            </div>
        </div>
    </div>

    <script>
        // Инициализация Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // Показываем имя пользователя
        const user = tg.initDataUnsafe.user;
        if (user) {
            document.getElementById('greeting').textContent = `Привет, ${user.first_name || 'друг'}!`;
        }

        // Управление модальным окном
        function openTokenModal() {
            document.getElementById('tokenModal').style.display = 'flex';
        }

        function closeTokenModal() {
            document.getElementById('tokenModal').style.display = 'none';
        }

        // Подключение к WB (пока заглушка)
        function connectToWB() {
            const token = document.getElementById('apiTokenInput').value;
            if (!token) return alert('Введите токен');
            
            closeTokenModal();
            document.getElementById('status-text').textContent = 'Подключено к WB';
            
            // Заглушка - здесь будет реальный API запрос
            setTimeout(() => {
                document.getElementById('val-income').textContent = '154 230₽';
                document.getElementById('val-ctr').textContent = '2.45%';
                document.getElementById('val-drr').textContent = '87.3%';
            }, 1000);
        }
    </script>
</body>
</html>